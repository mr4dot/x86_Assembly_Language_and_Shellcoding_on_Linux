### Machine Details 

```
Ubuntu 12.04 LTS Desktop 32 Bit 

Uname : mr4dot
Passwd : 123.com

Network : Bridge Mode 
```

#### Primary installations 
```
sudo apt-get update
sudo apt-get install nasm build-essential
```

#### If you face any issue in apt-get update 
```
sudo nano /etc/apt/sources.list

Locate the text
---------------
http://us.archive.ubuntu.com/ubuntu

and replace it with
-------------------
http://archive.ubuntu.com/ubuntu
```

#### issues while install openssh-server 

```
sudo apt-get install aptitude
sudo aptitude install openssh-server
```

## Exercise 1.2

#### Find CPU Details 

```shell
sanjuc@ubuntu:~/Desktop/SLAE$ lscpu 
Architecture:          i686
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                2
On-line CPU(s) list:   0,1
Thread(s) per core:    1
Core(s) per socket:    1
Socket(s):             2
Vendor ID:             GenuineIntel
CPU family:            6
Model:                 158
Stepping:              13
CPU MHz:               2304.000
BogoMIPS:              4608.00
Hypervisor vendor:     VMware
Virtualization type:   full
L1d cache:             32K
L1i cache:             32K
L2 cache:              256K
L3 cache:              16384K
sanjuc@ubuntu:~/Desktop/SLAE$ 
```

or 

```shell
sanjuc@ubuntu:~/Desktop/SLAE$ cat /proc/cpuinfo 
processor	: 0
vendor_id	: GenuineIntel
cpu family	: 6
model		: 158
model name	: Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz
stepping	: 13
microcode	: 0xf0
cpu MHz		: 2304.000
cache size	: 16384 KB
fdiv_bug	: no
f00f_bug	: no
coma_bug	: no
fpu		: yes
fpu_exception	: yes
cpuid level	: 22
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss nx pdpe1gb rdtscp lm constant_tsc arch_perfmon xtopology tsc_reliable nonstop_tsc eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch arat xsaveopt fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid rdseed adx smap
bogomips	: 4608.00
clflush size	: 64
cache_alignment	: 64
address sizes	: 45 bits physical, 48 bits virtual
power management:

processor	: 1
vendor_id	: GenuineIntel
cpu family	: 6
model		: 158
model name	: Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz
stepping	: 13
microcode	: 0xf0
cpu MHz		: 2304.000
cache size	: 16384 KB
fdiv_bug	: no
f00f_bug	: no
coma_bug	: no
fpu		: yes
fpu_exception	: yes
cpuid level	: 22
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss nx pdpe1gb rdtscp lm constant_tsc arch_perfmon xtopology tsc_reliable nonstop_tsc eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch arat xsaveopt fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid rdseed adx smap
bogomips	: 4608.00
clflush size	: 64
cache_alignment	: 64
address sizes	: 45 bits physical, 48 bits virtual
power management:

sanjuc@ubuntu:~/Desktop/SLAE$ 

```

#### Basic System Organisation 

```
 CPU 
  |
  |
  |-------system bus--------Memory
  |
  |
I/O Devices
```

#### Break ups of CPU 

![[Screenshot 2023-04-15 at 12.04.14 AM.png]]

1) **Control Unit**    - Retrieve or Decode instructions, Retrieve or Store data in memory 
2) Execution Unit - Actual Execution of instruction happens here 
3) Registers          - Internal memory locations used as 'varibles'
4) Flags                 - Used to indicate various 'events' when execution happening 

### Registers

![[Pasted image 20230415000915.png]]

### General Pupose 
----------------------
1) EAX - Accumulator Register - used to storing operands and result data 
2) EBX - Base register - pointer to data 
3) ECX - Counter Register - Loop operations 
4) EDX - Data Register - I/O pointer 
Can be seperated to 3 parts 
![[Pasted image 20230415001225.png]]
5) ESP - Stack pointer register
6) EBP - Stack data pointer register 
7) ESI - Data pointer register for memory operations 
8) EDI - Data pointer register for memory operations 
These set We can only seperated into 2 parts 
![[Pasted image 20230415001438.png]]

### Segment Registers 
![[Pasted image 20230415001921.png]]

## Exercise 1.2.1

```shell
sanjuc@ubuntu:~/Desktop/SLAE$ gdb /bin/bash 
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.launchpad.net/gdb-linaro/>...
Reading symbols from /bin/bash...(no debugging symbols found)...done.
(gdb) break main
Breakpoint 1 at 0x805eba6
(gdb) run
Starting program: /bin/bash 

Breakpoint 1, 0x0805eba6 in main ()
(gdb) info registers 
eax            0x1	1
ecx            0xbffff424	-1073744860
edx            0xbffff3b4	-1073744972
ebx            0xb7fa1ff4	-1208344588
esp            0xbffff37c	0xbffff37c
ebp            0xbffff388	0xbffff388
esi            0x0	0
edi            0x0	0
eip            0x805eba6	0x805eba6 <main+6>
eflags         0x246	[ PF ZF IF ]
cs             0x73	115
ss             0x7b	123
ds             0x7b	123
es             0x7b	123
fs             0x0	0
gs             0x33	51
(gdb) 
```

#### Accessing different posion of the memory EAX , AX , AH , AL

```
(gdb) display /x $eax
1: /x $eax = 0x1
(gdb) display /x $ecx
2: /x $ecx = 0xbffff424
(gdb) display /x $ax
3: /x $ax = 0x1
(gdb) display /x $ah
4: /x $ah = 0x0
(gdb) display /x $al
5: /x $al = 0x1
(gdb) 
```

### For Disassembling 

```shell
(gdb) info registers 
eax            0x1	1
ecx            0xbffff424	-1073744860
edx            0xbffff3b4	-1073744972
ebx            0xb7fa1ff4	-1208344588
esp            0xbffff37c	0xbffff37c
ebp            0xbffff388	0xbffff388
esi            0x0	0
edi            0x0	0
eip            0x805eba6	0x805eba6 <main+6>
eflags         0x246	[ PF ZF IF ]
cs             0x73	115
ss             0x7b	123
ds             0x7b	123
es             0x7b	123
fs             0x0	0
gs             0x33	51
(gdb) disa
disable      disassemble  
(gdb) disa
disable      disassemble  
(gdb) disa
disable      disassemble  
(gdb) disassemble $eip 
Dump of assembler code for function main:
   0x0805eba0 <+0>:	push   %ebp
   0x0805eba1 <+1>:	mov    %esp,%ebp
   0x0805eba3 <+3>:	push   %edi
   0x0805eba4 <+4>:	push   %esi
   0x0805eba5 <+5>:	push   %ebx
=> 0x0805eba6 <+6>:	and    $0xfffffff0,%esp
   0x0805eba9 <+9>:	sub    $0x100,%esp
   0x0805ebaf <+15>:	mov    0xc(%ebp),%eax
   0x0805ebb2 <+18>:	mov    0x10(%ebp),%edx
   0x0805ebb5 <+21>:	mov    %gs:0x14,%ecx
   0x0805ebbc <+28>:	mov    %ecx,0xfc(%esp)
   0x0805ebc3 <+35>:	xor    %ecx,%ecx
   0x0805ebc5 <+37>:	movl   $0x1,0x4(%esp)
   0x0805ebcd <+45>:	mov    %eax,0x34(%esp)
   0x0805ebd1 <+49>:	mov    %edx,0x2c(%esp)
   0x0805ebd5 <+53>:	movl   $0x812e400,(%esp)
   0x0805ebdc <+60>:	call   0x805e700 <__sigsetjmp@plt>
   0x0805ebe1 <+65>:	test   %eax,%eax
   0x0805ebe3 <+67>:	jne    0x805f267 <main+1735>
   0x0805ebe9 <+73>:	call   0x80700e0 <xtrace_init>
   0x0805ebee <+78>:	xchg   %ax,%ax
   0x0805ebf0 <+80>:	call   0x806cfe0 <check_dev_tty>
   0x0805ebf5 <+85>:	cmpl   $0x0,0x81297f0
   0x0805ebfc <+92>:	je     0x805ec15 <main+117>
   0x0805ebfe <+94>:	xchg   %ax,%ax
   0x0805ec00 <+96>:	movl   $0x3,(%esp)
   0x0805ec07 <+103>:	call   0x805e070 <sleep@plt>
   0x0805ec0c <+108>:	mov    0x81297f0,%eax
   0x0805ec11 <+113>:	test   %eax,%eax
   0x0805ec13 <+115>:	jne    0x805ec00 <main+96>
   0x0805ec15 <+117>:	call   0x80ab9e0 <set_default_locale>
   0x0805ec1a <+122>:	call   0x805e130 <getuid@plt>
   0x0805ec1f <+127>:	cmp    0x8125354,%eax
   0x0805ec25 <+133>:	mov    %eax,%ebx
   0x0805ec27 <+135>:	je     0x805ecae <main+270>
   0x0805ec2d <+141>:	mov    0x8125364,%eax
   0x0805ec32 <+146>:	test   %eax,%eax
   0x0805ec34 <+148>:	je     0x805ec4e <main+174>
   0x0805ec36 <+150>:	movl   $0x4a3,0x8(%esp)
   0x0805ec3e <+158>:	movl   $0x80f111f,0x4(%esp)
   0x0805ec46 <+166>:	mov    %eax,(%esp)
   0x0805ec49 <+169>:	call   0x80b2060 <sh_xfree>
   0x0805ec4e <+174>:	mov    0x8125368,%eax
   0x0805ec53 <+179>:	test   %eax,%eax
   0x0805ec55 <+181>:	je     0x805ec6f <main+207>
   0x0805ec57 <+183>:	movl   $0x4a4,0x8(%esp)
   0x0805ec5f <+191>:	movl   $0x80f111f,0x4(%esp)
   0x0805ec67 <+199>:	mov    %eax,(%esp)
   0x0805ec6a <+202>:	call   0x80b2060 <sh_xfree>
   0x0805ec6f <+207>:	mov    0x812536c,%eax
   0x0805ec74 <+212>:	test   %eax,%eax
   0x0805ec76 <+214>:	je     0x805ec90 <main+240>
   0x0805ec78 <+216>:	movl   $0x4a5,0x8(%esp)
   0x0805ec80 <+224>:	movl   $0x80f111f,0x4(%esp)
   0x0805ec88 <+232>:	mov    %eax,(%esp)
   0x0805ec8b <+235>:	call   0x80b2060 <sh_xfree>
   0x0805ec90 <+240>:	movl   $0x0,0x812536c
   0x0805ec9a <+250>:	movl   $0x0,0x8125368
---Type <return> to continue, or q <return> to quit---
```

### Change From AT&T to Intel (gdb default in AT&T Syntax)

```
(gdb) set disassembly-flavor intel 
(gdb) 
```


## HelloWorld 

```shell 
; hello world program
; Author : mr4dot

global _start

section .text

_start:
	;print hello world
	mov eax, 0x4
	mov ebx, 0x1
	mov ecx, message
	mov edx, mlen
	int 0x80


	;exit the program properly
	mov eax, 0x1
	mov ebx, 0x5
	int 0x80





section .data

	message: db  "Hello World"
	mlen equ $-message

```

```shell
root@ubuntu:/home/sanjuc/Desktop/program# ls
helloworld.asm
root@ubuntu:/home/sanjuc/Desktop/program# nasm -f elf32 -o HelloWorld.o helloworld.asm 
root@ubuntu:/home/sanjuc/Desktop/program# ls 
helloworld.asm  HelloWorld.o
root@ubuntu:/home/sanjuc/Desktop/program# ld -o HelloWorld HelloWorld.o 
root@ubuntu:/home/sanjuc/Desktop/program# ls 
HelloWorld  helloworld.asm  HelloWorld.o
root@ubuntu:/home/sanjuc/Desktop/program# ./HelloWorld 
Hello Worldroot@ubuntu:/home/sanjuc/Desktop/program# 
```

